import{s as le,p as G,f as E,a as S,g as x,h as F,c as C,d as g,j as W,i as M,w as k,X as H,J as re,l as P,m as O,n as K,Z as B}from"../chunks/scheduler.8de5dfe6.js";import{S as ie,i as de,j as Q,b as T,d as J,m as j,a as D,t as L,e as V}from"../chunks/index.2f036f68.js";import{S as U,b as q,a as ce,M as Y,c as X,d as ee,n as ne,t as Z,h as R,u as fe,i as ue,j as te,k as _e}from"../chunks/SendTransactionButton.7d6705b8.js";import{k as ae}from"../chunks/radixDappToolkit.d76b9e76.js";import{T as se}from"../chunks/Textfield.32f1f861.js";function oe(l){let s,p,i=l[2].componentAddress+"",a,o,f,_=JSON.stringify(l[2].addresses,null,2)+"",d,h,m,c=JSON.stringify(l[2].config,null,2)+"",I;return{c(){s=E("pre"),p=P("Component address: "),a=P(i),o=S(),f=E("pre"),d=P(_),h=S(),m=E("pre"),I=P(c)},l(t){s=x(t,"PRE",{});var r=F(s);p=O(r,"Component address: "),a=O(r,i),r.forEach(g),o=C(t),f=x(t,"PRE",{});var n=F(f);d=O(n,_),n.forEach(g),h=C(t),m=x(t,"PRE",{});var A=F(m);I=O(A,c),A.forEach(g)},m(t,r){M(t,s,r),k(s,p),k(s,a),M(t,o,r),M(t,f,r),k(f,d),M(t,h,r),M(t,m,r),k(m,I)},p(t,r){r&4&&i!==(i=t[2].componentAddress+"")&&K(a,i),r&4&&_!==(_=JSON.stringify(t[2].addresses,null,2)+"")&&K(d,_),r&4&&c!==(c=JSON.stringify(t[2].config,null,2)+"")&&K(I,c)},d(t){t&&(g(s),g(o),g(f),g(h),g(m))}}}function pe(l){let s,p,i,a,o,f,_,d,h,m,c,I,t,r,n=l[2]&&oe(l);function A(e){l[6](e)}let w={label:"Start index"};l[0]!==void 0&&(w.value=l[0]),o=new se({props:w}),G.push(()=>Q(o,"value",A));function $(e){l[7](e)}let y={label:"Start index"};return l[1]!==void 0&&(y.value=l[1]),d=new se({props:y}),G.push(()=>Q(d,"value",$)),c=new U({props:{text:"Airdrop Block",buildManifestFn:l[8]}}),c.$on("transactionSucceeded",l[9]),c.$on("transactionFailed",me),t=new U({props:{text:"Claim Block Payments",buildManifestFn:l[10]}}),t.$on("transactionSucceeded",l[11]),t.$on("transactionFailed",ge),{c(){s=E("div"),n&&n.c(),p=S(),i=E("div"),a=E("div"),T(o.$$.fragment),_=S(),T(d.$$.fragment),m=S(),T(c.$$.fragment),I=S(),T(t.$$.fragment),this.h()},l(e){s=x(e,"DIV",{class:!0});var u=F(s);n&&n.l(u),p=C(u),i=x(u,"DIV",{class:!0});var v=F(i);a=x(v,"DIV",{class:!0});var b=F(a);J(o.$$.fragment,b),_=C(b),J(d.$$.fragment,b),m=C(b),J(c.$$.fragment,b),b.forEach(g),I=C(v),J(t.$$.fragment,v),v.forEach(g),u.forEach(g),this.h()},h(){W(a,"class","flex gap-2 items-baseline"),W(i,"class","flex flex-col gap-4 w-max"),W(s,"class","flex flex-col gap-4 w-2/3 m-auto p-8")},m(e,u){M(e,s,u),n&&n.m(s,null),k(s,p),k(s,i),k(i,a),j(o,a,null),k(a,_),j(d,a,null),k(a,m),j(c,a,null),k(i,I),j(t,i,null),r=!0},p(e,[u]){e[2]?n?n.p(e,u):(n=oe(e),n.c(),n.m(s,p)):n&&(n.d(1),n=null);const v={};!f&&u&1&&(f=!0,v.value=e[0],H(()=>f=!1)),o.$set(v);const b={};!h&&u&2&&(h=!0,b.value=e[1],H(()=>h=!1)),d.$set(b);const N={};u&3&&(N.buildManifestFn=e[8]),c.$set(N)},i(e){r||(D(o.$$.fragment,e),D(d.$$.fragment,e),D(c.$$.fragment,e),D(t.$$.fragment,e),r=!0)},o(e){L(o.$$.fragment,e),L(d.$$.fragment,e),L(c.$$.fragment,e),L(t.$$.fragment,e),r=!1},d(e){e&&g(s),n&&n.d(),V(o),V(d),V(c),V(t)}}}const me=()=>"Buying blocks failed",ge=()=>"Claiming payments failed";function be(l,s,p){let i;const{currentBillboardComponent:a}=q;re(l,a,n=>p(2,i=n));let o="0",f="9999";function _(n,A){var z;const w=(z=B(ae))==null?void 0:z.address,$=B(a),y=$.config,e=_e(n,A),u=ce(y.block_image_config),v=B(a).addresses.owner_badge_global_id.split(":"),b=v[0],N=v[1];return new Y().callMethod(w,"create_proof_of_non_fungibles",[X(b),ee("NonFungibleLocalId",ne(N))]).callMethod($.componentAddress,"update_config",[Z(R(0),R(y.block_data_security_deposit_amount),u)]).callMethod(w,"withdraw",[X($.xrdResourceAddress),R(0)]).takeAllFromWorktop($.xrdResourceAddress,"payment").callMethod($.componentAddress,"buy_block",[Z(fe(e)),ue("payment")]).callMethod($.componentAddress,"update_config",[Z(R(y.block_price_xrd),R(y.block_data_security_deposit_amount),u)]).callMethod(w,"deposit_batch",[te("ENTIRE_WORKTOP")]).build()}function d(){var e;const n=(e=B(ae))==null?void 0:e.address,A=B(a),w=B(a).addresses.owner_badge_global_id.split(":"),$=w[0],y=w[1];return new Y().callMethod(n,"create_proof_of_non_fungibles",[X($),ee("NonFungibleLocalId",ne(y))]).callMethod(A.componentAddress,"claim_block_payments",[]).callMethod(n,"deposit_batch",[te("ENTIRE_WORKTOP")]).build()}function h(n){o=n,p(0,o)}function m(n){f=n,p(1,f)}return[o,f,i,a,_,d,h,m,()=>(console.log(_(parseInt(o),parseInt(f))),{manifest:_(parseInt(o),parseInt(f)),message:"Buy blocks"}),async()=>q.refreshComponent(),()=>({manifest:d(),message:"Claim payments"}),async()=>q.refreshComponent()]}class we extends ie{constructor(s){super(),de(this,s,be,pe,le,{})}}export{we as component};
