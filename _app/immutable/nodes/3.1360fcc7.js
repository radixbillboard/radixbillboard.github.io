import{s as X,f as A,a as w,g as B,h as C,c as S,d as m,j as T,i as y,w as h,J as Y,l as M,m as v,n as I,Z as $}from"../chunks/scheduler.8de5dfe6.js";import{S as ee,i as ne,b as J,d as x,m as L,a as W,t as j,e as D}from"../chunks/index.2f036f68.js";import{S as K,b as E,a as te,M as V,c as F,d as q,n as Z,t as R,h as k,u as ae,i as se,j as z,k as oe}from"../chunks/SendTransactionButton.5f852f17.js";import{k as G}from"../chunks/radixDappToolkit.d76b9e76.js";function H(i){let a,_,l=i[0].componentAddress+"",s,u,r,f=JSON.stringify(i[0].addresses,null,2)+"",n,o,d,c=JSON.stringify(i[0].config,null,2)+"",g;return{c(){a=A("pre"),_=M("Component address: "),s=M(l),u=w(),r=A("pre"),n=M(f),o=w(),d=A("pre"),g=M(c)},l(e){a=B(e,"PRE",{});var t=C(a);_=v(t,"Component address: "),s=v(t,l),t.forEach(m),u=S(e),r=B(e,"PRE",{});var p=C(r);n=v(p,f),p.forEach(m),o=S(e),d=B(e,"PRE",{});var b=C(d);g=v(b,c),b.forEach(m)},m(e,t){y(e,a,t),h(a,_),h(a,s),y(e,u,t),y(e,r,t),h(r,n),y(e,o,t),y(e,d,t),h(d,g)},p(e,t){t&1&&l!==(l=e[0].componentAddress+"")&&I(s,l),t&1&&f!==(f=JSON.stringify(e[0].addresses,null,2)+"")&&I(n,f),t&1&&c!==(c=JSON.stringify(e[0].config,null,2)+"")&&I(g,c)},d(e){e&&(m(a),m(u),m(r),m(o),m(d))}}}function re(i){let a,_,l,s,u,r,f,n=i[0]&&H(i);return s=new K({props:{text:"Buy All Blocks",buildManifestFn:i[4]}}),s.$on("transactionSucceeded",i[5]),s.$on("transactionFailed",le),r=new K({props:{text:"Claim Block Payments",buildManifestFn:i[6]}}),r.$on("transactionSucceeded",i[7]),r.$on("transactionFailed",ce),{c(){a=A("div"),n&&n.c(),_=w(),l=A("div"),J(s.$$.fragment),u=w(),J(r.$$.fragment),this.h()},l(o){a=B(o,"DIV",{class:!0});var d=C(a);n&&n.l(d),_=S(d),l=B(d,"DIV",{class:!0});var c=C(l);x(s.$$.fragment,c),u=S(c),x(r.$$.fragment,c),c.forEach(m),d.forEach(m),this.h()},h(){T(l,"class","flex gap-4"),T(a,"class","flex flex-col gap-4 w-2/3 m-auto p-8")},m(o,d){y(o,a,d),n&&n.m(a,null),h(a,_),h(a,l),L(s,l,null),h(l,u),L(r,l,null),f=!0},p(o,[d]){o[0]?n?n.p(o,d):(n=H(o),n.c(),n.m(a,_)):n&&(n.d(1),n=null)},i(o){f||(W(s.$$.fragment,o),W(r.$$.fragment,o),f=!0)},o(o){j(s.$$.fragment,o),j(r.$$.fragment,o),f=!1},d(o){o&&m(a),n&&n.d(),D(s),D(r)}}}const le=()=>"Buying blocks failed",ce=()=>"Claiming payments failed";function de(i,a,_){let l;const{currentBillboardComponent:s}=E;Y(i,s,c=>_(0,l=c));function u(c,g){var O;const e=(O=$(G))==null?void 0:O.address,t=$(s),p=t.config,b=oe(c,g),N=te(p.block_image_config),P=$(s).addresses.owner_badge_global_id.split(":"),Q=P[0],U=P[1];return new V().callMethod(e,"create_proof_of_non_fungibles",[F(Q),q("NonFungibleLocalId",Z(U))]).callMethod(t.componentAddress,"update_config",[R(k(0),k(p.block_data_security_deposit_amount),N)]).callMethod(e,"withdraw",[F(t.xrdResourceAddress),k(0)]).takeAllFromWorktop(t.xrdResourceAddress,"payment").callMethod(t.componentAddress,"buy_block",[R(ae(b)),se("payment")]).callMethod(t.componentAddress,"update_config",[R(k(p.block_price_xrd),k(p.block_data_security_deposit_amount),N)]).callMethod(e,"deposit_batch",[z("ENTIRE_WORKTOP")]).build()}function r(){var b;const c=(b=$(G))==null?void 0:b.address,g=$(s),e=$(s).addresses.owner_badge_global_id.split(":"),t=e[0],p=e[1];return new V().callMethod(c,"create_proof_of_non_fungibles",[F(t),q("NonFungibleLocalId",Z(p))]).callMethod(g.componentAddress,"claim_block_payments",[]).callMethod(c,"deposit_batch",[z("ENTIRE_WORKTOP")]).build()}return[l,s,u,r,()=>({manifest:u(0,9999),message:"Buy blocks"}),async()=>E.refreshComponent(),()=>({manifest:r(),message:"Claim payments"}),async()=>E.refreshComponent()]}class _e extends ee{constructor(a){super(),ne(this,a,de,re,X,{})}}export{_e as component};
